# Spring Boot 新增示例说明

## 📦 新增示例概览

本次新增了5个Spring Boot进阶学习示例，涵盖实际开发中最常用的功能。

### 示例列表

| 示例名称 | 主类 | 说明 | 运行命令 |
|---------|------|------|---------|
| **validation** | ValidationApplication | 表单验证和数据校验 | `./run-app.sh validation` |
| **exception** | ExceptionHandlingApplication | 异常处理和统一响应 | `./run-app.sh exception` |
| **config** | ConfigPropertiesApplication | 配置属性管理 | `./run-app.sh config` |
| **interceptor** | InterceptorApplication | 拦截器和过滤器 | `./run-app.sh interceptor` |
| **fileupload** | FileUploadApplication | 文件上传下载 | `./run-app.sh fileupload` |

---

## 1. 表单验证示例（ValidationApplication）

### 学习目标
- 掌握Jakarta Validation（JSR-380）注解的使用
- 理解@Valid和@Validated的区别
- 学会自定义验证错误响应
- 掌握分组验证和嵌套对象验证

### 核心功能
- 用户注册表单验证（@NotBlank, @Email, @Min, @Max, @Pattern）
- 产品创建验证（@Positive, @Size）
- 预约日期验证（@Future）
- 统一验证异常处理

### 测试示例
```bash
# 启动应用
./run-app.sh validation

# 测试用户注册（正确）
curl -X POST http://localhost:8080/api/validation/register \
  -H "Content-Type: application/json" \
  -d '{"username":"zhangsan","email":"test@example.com","age":25,"password":"123456"}'

# 测试用户注册（验证失败）
curl -X POST http://localhost:8080/api/validation/register \
  -H "Content-Type: application/json" \
  -d '{"username":"ab","email":"invalid","age":15,"password":"123"}'

# 查看验证规则
curl http://localhost:8080/api/validation/rules
```

### 核心注解
- `@NotNull` / `@NotEmpty` / `@NotBlank`
- `@Size(min, max)`
- `@Min` / `@Max`
- `@Email`
- `@Pattern(regexp)`
- `@Past` / `@Future`
- `@Positive` / `@Negative`

---

## 2. 异常处理示例（ExceptionHandlingApplication）

### 学习目标
- 理解Spring Boot的异常处理机制
- 掌握@ExceptionHandler的使用
- 学会使用@ControllerAdvice进行全局异常处理
- 掌握自定义业务异常的创建和使用
- 了解如何返回统一的错误响应格式

### 核心功能
- 自定义业务异常（ResourceNotFoundException, BusinessException等）
- 全局异常处理器（@ControllerAdvice + @ExceptionHandler）
- 统一错误响应格式
- HTTP状态码的正确使用

### 测试示例
```bash
# 启动应用
./run-app.sh exception

# 测试资源未找到异常（404）
curl http://localhost:8080/api/exception/users/999

# 测试业务异常（400）
curl http://localhost:8080/api/exception/divide/10/0

# 测试权限异常（403）
curl -X DELETE http://localhost:8080/api/exception/users/1

# 测试系统异常（500）
curl http://localhost:8080/api/exception/error

# 查看使用指南
curl http://localhost:8080/api/exception/guide
```

### 异常类型
- **ResourceNotFoundException**：资源未找到（404）
- **BusinessException**：业务异常（400）
- **ValidationException**：验证异常（400）
- **PermissionDeniedException**：权限不足（403）
- **RuntimeException**：系统异常（500）

---

## 3. 配置属性示例（ConfigPropertiesApplication）

### 学习目标
- 掌握@Value注解注入配置值
- 理解@ConfigurationProperties的使用
- 学会配置文件的层级结构
- 掌握不同数据类型的配置注入
- 了解配置的优先级和覆盖规则

### 核心功能
- @Value简单配置注入
- @ConfigurationProperties批量配置注入
- 支持String、数字、布尔、List、Map等类型
- 嵌套配置对象（如security.jwt.secret）
- 配置的默认值

### 配置示例（application.yml）
```yaml
app:
  name: Spring Boot学习示例
  version: 1.0.0
  features:
    - RESTful API
    - Spring Data JPA
  contacts:
    email: example@springboot.com
    github: https://github.com/spring-boot

database:
  url: jdbc:h2:mem:testdb
  max-connections: 20
  timeout: 60

security:
  jwt:
    secret: my-secret-key
    expiration: 86400000
  cors:
    enabled: true
    allowed-origins:
      - http://localhost:3000
```

### 测试示例
```bash
# 启动应用
./run-app.sh config

# 查看应用配置
curl http://localhost:8080/api/config/app

# 查看数据库配置
curl http://localhost:8080/api/config/database

# 查看安全配置
curl http://localhost:8080/api/config/security

# 查看所有配置
curl http://localhost:8080/api/config/all

# 查看配置使用指南
curl http://localhost:8080/api/config/guide
```

---

## 4. 拦截器和过滤器示例（InterceptorApplication）

### 学习目标
- 理解Filter和Interceptor的区别
- 掌握Filter的创建和注册
- 掌握Interceptor的创建和配置
- 了解请求处理的完整流程
- 学会使用拦截器实现通用功能

### Filter vs Interceptor

| 特性 | Filter（过滤器） | Interceptor（拦截器） |
|-----|----------------|---------------------|
| 规范 | Servlet规范 | Spring MVC |
| 级别 | 容器级别 | Spring级别 |
| 拦截范围 | 所有请求 | Controller请求 |
| 访问Spring上下文 | 否 | 是 |
| 使用场景 | 字符编码、CORS、XSS防御 | 登录验证、权限检查、日志 |

### 核心功能
- LoggingFilter：请求日志记录
- EncodingFilter：字符编码设置
- AuthenticationInterceptor：登录验证
- PerformanceInterceptor：性能监控

### 测试示例
```bash
# 启动应用
./run-app.sh interceptor

# 测试公开接口（无需token）
curl http://localhost:8080/api/demo/public

# 测试受保护接口（无token，返回401）
curl http://localhost:8080/api/demo/protected

# 测试受保护接口（有token，成功）
curl -H "Authorization: Bearer valid-token" \
  http://localhost:8080/api/demo/protected

# 测试慢接口（查看性能监控日志）
curl http://localhost:8080/api/demo/slow

# 查看使用指南
curl http://localhost:8080/api/demo/guide
```

### 执行顺序
```
1. LoggingFilter - 记录请求开始
2. EncodingFilter - 设置字符编码
3. PerformanceInterceptor.preHandle - 开始计时
4. AuthenticationInterceptor.preHandle - 验证登录
5. Controller方法执行
6. AuthenticationInterceptor.postHandle
7. PerformanceInterceptor.afterCompletion - 计算耗时
8. AuthenticationInterceptor.afterCompletion
9. LoggingFilter - 记录请求结束
```

---

## 5. 文件上传下载示例（FileUploadApplication）

### 学习目标
- 掌握MultipartFile处理文件上传
- 学会文件的存储和管理
- 实现文件下载功能
- 掌握文件类型验证和大小限制
- 了解文件上传的安全性考虑

### 核心功能
- 单文件上传
- 多文件批量上传
- 文件下载
- 文件列表查询
- 文件删除
- 文件类型和大小验证

### 文件限制
- **最大文件大小**：10MB
- **支持的文件类型**：txt, pdf, doc, docx, xls, xlsx, jpg, jpeg, png, gif, svg

### 测试示例
```bash
# 启动应用
./run-app.sh fileupload

# 创建测试文件
echo "Hello, Spring Boot!" > test.txt

# 单文件上传
curl -X POST -F "file=@test.txt" \
  http://localhost:8080/api/files/upload

# 多文件上传
echo "File 1" > file1.txt
echo "File 2" > file2.txt
curl -X POST -F "files=@file1.txt" -F "files=@file2.txt" \
  http://localhost:8080/api/files/upload-multiple

# 查看所有文件
curl http://localhost:8080/api/files

# 下载文件
curl -O http://localhost:8080/api/files/download/filename.txt

# 删除文件
curl -X DELETE http://localhost:8080/api/files/filename.txt

# 查看使用指南
curl http://localhost:8080/api/files/guide
```

### 技术要点
- MultipartFile：文件上传接口
- Path/Files：Java NIO文件操作
- Resource：Spring资源抽象
- Content-Disposition：控制文件下载
- UUID：生成唯一文件名防止重名

---

## 🚀 快速开始

### 1. 查看所有可用示例
```bash
cd spring-boot-examples
./run-app.sh
```

### 2. 运行指定示例
```bash
# 基础示例
./run-app.sh quickstart
./run-app.sh restful
./run-app.sh jpa

# 进阶示例
./run-app.sh validation
./run-app.sh exception
./run-app.sh config
./run-app.sh interceptor
./run-app.sh fileupload
```

### 3. 使用VS Code调试
1. 打开spring-boot-examples目录
2. 按F5启动调试
3. 选择对应的调试配置（如"Validation"、"Exception Handling"等）
4. 设置断点进行调试

---

## 📚 学习路径建议

### 第1周：基础示例
1. **Day 1-2**：QuickStart - 了解Spring Boot基本结构
2. **Day 3-4**：Restful - 掌握RESTful API开发
3. **Day 5-7**：JPA - 学习数据库操作

### 第2周：进阶示例
1. **Day 1-2**：Validation - 掌握数据验证
2. **Day 3-4**：Exception - 学习异常处理
3. **Day 5**：Config - 理解配置管理
4. **Day 6**：Interceptor - 掌握拦截器和过滤器
5. **Day 7**：FileUpload - 实现文件上传下载

### 第3周：综合实战
结合所有学到的知识，开发一个完整的小项目（如：博客系统、任务管理系统等）

---

## 💡 提示

1. **日志查看**：所有示例都有详细的控制台日志输出，启动后注意查看
2. **API文档**：每个示例都有 `/guide` 接口，返回使用指南
3. **断点调试**：建议在学习时设置断点，观察程序执行流程
4. **修改实验**：鼓励修改代码，加深理解
5. **组合使用**：实际项目中这些功能会组合使用

---

## 🔗 相关文档

- [Maven介绍](Maven介绍.md)
- [快速开始](快速开始.md)
- [SpringBoot学习路径](../SpringBoot学习路径.md)
- [SpringBoot实战总结](../SpringBoot实战总结.md)

---

## 📝 总结

新增的5个示例涵盖了Spring Boot开发中最常用的功能：

✅ **Validation** - 保证数据质量
✅ **Exception** - 优雅处理错误
✅ **Config** - 灵活管理配置
✅ **Interceptor** - 实现通用逻辑
✅ **FileUpload** - 处理文件操作

结合之前的3个基础示例（QuickStart、Restful、JPA），你现在有了一套完整的Spring Boot学习体系！

**开始你的学习之旅吧！** 🚀
